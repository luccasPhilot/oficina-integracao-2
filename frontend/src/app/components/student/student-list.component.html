<page [title]="'Lista de alunos'" [objectName]="'ALUNO'" [showAddButton]="true" [showSearchBar]="true"
  [dataSource]="studentsList" (addButtonClicked)="addStudent()">

  @if (feedbackMessage()) {
  <app-feedback-popup [message]="feedbackMessage()" [type]="feedbackType()"></app-feedback-popup>
  }

  <div class="student-list">
    <mat-accordion hideToggle>
      <mat-expansion-panel disabled>
        <mat-expansion-panel-header>
          <mat-panel-title>Nome</mat-panel-title>
          <mat-panel-description>Escola</mat-panel-description>
          <mat-panel-description>Idade</mat-panel-description>
          <mat-panel-description>Data de inclusão</mat-panel-description>
          <mat-panel-description class="panel-actions actions-col"></mat-panel-description>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
      <mat-expansion-panel *ngIf="listHasStudents()" disabled>
        <mat-expansion-panel-header>
          <mat-panel-title>Nenhum aluno foi encontrado.</mat-panel-title>
        </mat-expansion-panel-header>
      </mat-expansion-panel>
      <mat-expansion-panel *ngFor="let student of studentsList" class="student-panel">
        <mat-expansion-panel-header style="cursor: pointer !important;" *ngIf="!student.filtered">
          <mat-panel-title>
            <div class="student-header">
              <div class="student-initial">{{ getInitials(student.nome) }}</div>
              <div class="student-info">
                <div class="student-name">{{ student.nome }}</div>
                <div class="student-class">{{ student.turma?.identificacao }}</div>
              </div>
            </div>
          </mat-panel-title>
          <mat-panel-description>{{ student.escola?.nome }}</mat-panel-description>
          <mat-panel-description>{{ student.idade || '-' }}</mat-panel-description>
          <mat-panel-description>{{ student.createdAt | date : "dd 'de' MMMM 'de' y" }}</mat-panel-description>
          <mat-panel-description class="panel-actions actions-col">
            <button mat-icon-button class="icon-button" [matTooltip]="'Editar'" (click)="editStudent(student, $event)">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button class="icon-button" [matTooltip]="'Deletar'"
              (click)="deleteStudent(student, $event)">
              <mat-icon>delete</mat-icon>
            </button>
          </mat-panel-description>
        </mat-expansion-panel-header>

        <div class="student-details">
          <div class="detail-row">
            <span class="detail-label">Nome completo:</span>
            <span class="detail-value">{{ student.nome }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Turma:</span>
            <span class="detail-value">{{ student.turma?.identificacao }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Escola:</span>
            <span class="detail-value">{{ student.escola?.nome }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Idade:</span>
            <span class="detail-value">{{ student.idade || '-' }}</span>
          </div>

          <div class="detail-row">
            <span class="detail-label">Data de inclusão:</span>
            <span class="detail-value">
              {{ student.createdAt | date : "dd 'de' MMMM 'de' y 'às' HH:mm" }}
            </span>
          </div>
        </div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</page>